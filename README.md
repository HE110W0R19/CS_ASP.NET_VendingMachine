# Автомат по продаже напитков 
##### В данном проекте Бекенд часть выполнен на ASP.NET Core WEB API с полноценной архитектурой, Фронтенд приложение было сделано на NextJS(React), База данных использоваласть PostgreSQL
*```Проект не использует никакие посторонние сервисы, все работает на localhost-е```*

## Бекенд часть:
[![N|Solid](https://syncfusioninc.gallerycdn.vsassets.io/extensions/syncfusioninc/aspnetcoreextensions/24.2.3/1706702486370/Microsoft.VisualStudio.Services.Icons.Default)]()

#### Бекенд часть состоит из нескольких слоев
- Сам основной проект VendingMachine
- VendingMachine.Application
- VendingMachine.Core
- VendingMachine.DataAccess

****!!!Перед тем как запустить проет, советую поменять строку подключения, затем написать команду ```(update-database)``` в консоле диспетчера пакетов****
(ConnectionString указан в файле "appsettings.Development.json")

**Основной проект**
Основной проект содержит в себе контроллеры (для админа и пользователя) и контракты для Coin и Drink (это обычное рекорды), которые используются для получения и отпраки объектов в запросе

**Проект содержит такие пакеты, как:**
```sh
Swashbuckle.AspNetCore
Microsoft.EntityFrameworkCore.Design
```

**Слой .Core** - содержит модели, тут лежат основные domain модели которые включают в себя основную логику 

В данном проекте в нем хранятся модели ```"Coin-монета"``` и ```"Drink - напиток"```, а так же интерфейсы(Абстракции)
```Модель/класс Coin``` содержит в себе публичные get свойства(без set, так как это доменная модель), публичные константные поля(для проверки валидации), приватный конструктор, и публичный статический метод CreateCoin, предназначенный для создания экземпляра класса Coin с дополнительной проверки валидации.
```Модель/класс Drink``` точно также содержит свойства, константные поля, и приватный "инкапсулированный" конструктор

**Слой .DataAccess** - эта чать содержит слой с базой данных(при разработки БД использовался подход CodeFirst). В нем хранятся наши Entity модели, миграции, конфигурации, в папке Repositories хранятся классы c логикой, предназначенные для работы с моделями (GET/CREATE/UPDATE/DELETE)
**Этот слой содержит такие пакеты, как:**
```sh
Microsoft.EntityFrameworkCore
Microsoft.EntityFrameworkCore.Tools
Npgsql.EntityFrameworkCore.PostgreSQL
```
**Слой .Application** - этот слой содержит бизнес логику (сервисы), эта часть позволяет соединять нашу базу данных с контроллерам. В этойчасти мы можем получать, создавать данные, кеширование, обращение к другим БД итд.
В данной части были созданы два класса ```CoinsService``` , ```DrinksService``` и зарегистрированны в ```Program.cs``` через ```AddScoped<>```
```
builder.Services.AddScoped<IDrinksService, DrinksService>();
builder.Services.AddScoped<IDrinksRepository, DrinksRepository>();
builder.Services.AddScoped<ICoinService, CoinsService>();
builder.Services.AddScoped<ICoinsRepository, CoinsRepository>();
```

*На самом деле можно было и не использовать такую архитектуру (для каких то мелких приложений), лучше всего она подходит для каких то крупных проектов, которые в дальнейшем можно будет доробатывать и обсуживать.*


## Фронтенд часть:
[![N|Solid](https://jlannoo.dev/skills/next.png)]()

#### Фронтенд часть был создан с использованием ```Next.JS``` и библиотеки ```Ant Design```
```
NextJS: npx create-next-app@latest
Antd: npm install antd --save
```
**Работа производилась в Visual Code**
##### Перед тем как запустить фронтенд проект, нужно перейти в папку ```./VendingMachineFrontend/vending-machine/``` и там запустить проект через команду ```npm run dev```
##### После успешного запуска приложения нужно в браузере перейти по адресу ```http://localhost:3000```
##### Чтобы зайти как ```админ```, нужно перейти по адресу с указанием специального ключа ```http://localhost:3000/?key=admin123```

**При запуске приложения через админа у нас появляется возможность добавлять\удалять\редактировать\создавать нужные нам монеты и напитки при помощи модальных окон**

**При запуские приложения через покупателя у вас отображаются доступные элементы, которые находятся внутри автомата (элементы которые были добавленны админом), недоступные монеты просто не отображаюся**
**Отображаются карточки напитков с кнопкой ```Buy``` для покупки и карточки с доступными монетами, так же с кнопкой ```Add``` для внесения монет(При нажатии у вас есть возможность ввести нужное кол-во монет(которые вы хотите вносите), затем идет подсчет и отображение общей внесенной суммы)**

**После внесения нужного кол-во монет, идет подсчет общей внесенной суммы, затем, если достаточно средств, при наатии на кнопку ```Buy``` на карточке напитка, происходит покупка одного напитка, конечно же в БД обновляется информация о напитке, так же в БД сначала поступают все монеты, затем после расчета сдачи, из БД вытягиваются доступные для сдачи монеты(забираем монеты из автомата для сдачи), идет подсчет новых монет для сдач, и сдача автоматически вносится в автомат(можно заметить как добавятся новые монеты в списке внесенных монет), это сделано специально чтобы можно было понять какие монеты вернул автомат(можно было так же реализовать сделав отдельный блок, где будет отображаться конкретно сдача, просто добавив еще один раздел с монетами)**

**Папка admin содержит в себе один файлик ```page.tsx```, это страничка админа. В этом файлике вся логика наших карточек товаров и монет. Так же в нем описано поведение модального окна, которое позволяет редактировать или создавать товар, в нем единственная функция ```AdminPage``` которая возвращает нам компоненты странички(две кнопки для добавления(создания) товаров, и карточки с товарами(если они есть), которые так же содержат две кнопки для редактрования или удаления товара)**

**Папка ```components``` содержит в себе сами шаблоны компонентов (сами карточки для напитков и монет, модальные окна для редактирования или создания напитка или монеты), как для админа, так и для юзера**

**Папка ```Models``` содержит в себе модельки Монет и Напитков, это обычные интерфейсы с почти такими же полями как и модельки из бекенда**

**Папка ```Services``` содержит в себе логику для отправки запрпосов через ```fetch```** 

